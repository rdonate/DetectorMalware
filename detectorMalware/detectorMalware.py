import re
def split_Source(source):
    source=re.sub('"','',source)
    source=source.split(",")
    if len(source)>1 and not source[1]=='Class':
        source[1]=int(source[1])
    return tuple(source)


def main():
    from envparse import env
    seed=1234
    sample = env.bool("SAMPLE", default=False)
    with open("/data/raw/DataBase/trainLabels.csv","r") as file:
        text = file.read()
    sources = list(map(split_Source, text.split('\n')))[:-1]
    if sample:
        from src.misc.sample import selectSample
        sources = selectSample(5,seed,sources)
    del sample
    from src.mongo.database import DataBaseMongo
    ip_Server_Mongo = env.str("IP_SERVER_MONGO", default="172.16.0.2")
    db_Name = env.str("DB_NAME", default="tfg")
    db = DataBaseMongo(ip_Server_Mongo, db_Name)
    del ip_Server_Mongo, db_Name
    collection = db.selectCollection("test")
    obj = {"x": 1, "y": 2}
    collection.insert(obj)
    find = collection.find()
    for c in find:
        print(c)
    del find, collection, obj, db
if __name__ == '__main__':
    main()