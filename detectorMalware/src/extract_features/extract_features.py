#! - * - coding UTF-8 - * -
from src.extract_features.extract_feature_bytes import extract_Feature_Byte as bytes
from src.extract_features.extract_feature_asm import extract_Features_Asm as asm
from src.mongo.database import DataBaseMongo


def extract_features(ip_Server_Mongo, db_Name, dir_Data_Raw, prefix_collections, order, names_collections, source):
    db = DataBaseMongo(ip_Server_Mongo, db_Name)
    collection_total = db.selectCollection(prefix_collections + '_' + names_collections[0])
    data = {'_id':source[0], 'name_file':source[1]}
    if len(source)==3:
        data['label']=source[2]
    collection_total.insert(data)
    del data, db, collection_total
    bytes(prefix_collections, ip_Server_Mongo, db_Name, dir_Data_Raw, source, order,names_collections)
    asm(prefix_collections, ip_Server_Mongo, db_Name, dir_Data_Raw, source, names_collections)
