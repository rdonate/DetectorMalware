#! - * - coding UTF-8 - * -

from src.model.select_features_kind import select_features
from src.model.validation import crossvalidation
from xgboost import XGBClassifier

def create_Model(prefix_collection, ip_Server_Mongo, db_Name,names_collections, lenght, num_features, num_features_use, seed):
    features, labels = select_features(ip_Server_Mongo, db_Name, prefix_collection, names_collections, num_features, lenght)
    labels = labels - 1
    features1=features[:,:num_features_use]
    model = XGBClassifier(n_estimators=100, silent=True, objective='multi:softprob', booster='gbtree', seed=(seed*2), nthread=-1)
    score = crossvalidation(model, features1, labels, 'neg_log_loss', seed)
    print('Values of Scores mean: {}'.format(score.mean()))
    return model.fit(features,labels)
