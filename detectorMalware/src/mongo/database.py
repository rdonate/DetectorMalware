# -*- coding: utf-8 -*-

import pymongo
from .collection import collectionMongo

class DataBaseMongo:

    def __init__(self,url,nameDB="tfg"):
        assert isinstance(url,str), "The address of the url, %s , not is a type string." %url
        self.connection=pymongo.MongoClient("mongodb://"+url)
        assert isinstance(nameDB,str), "The name of the Database, %s , not is a type string." %nameDB
        self.db=self.connection[nameDB]

    def selectCollection(self,nameCollection):
        assert isinstance(nameCollection, str), "The name of the Collection, %s , not is a type string." % nameCollection
        return collectionMongo(self.db,nameCollection)

def databaseMongo(url,nameDB="tfg"):
    db = DataBaseMongo(url,nameDB)
    return db
