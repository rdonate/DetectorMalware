# -*- coding: utf-8 -*-

import pymongo
from .collection import CollectionMongo

class DataBaseMongo:

    def __init__(self,url,nameDB="tfg"):
        assert isinstance(url,str), "The address of the url, %s , not is a type string." %url
        try:
            self.connection=pymongo.MongoClient("mongodb://"+url)
        except Exception as e:
            print(e)
        assert isinstance(nameDB,str), "The name of the Database, %s , not is a type string." %nameDB
        try:
            self.db=self.connection[nameDB]
        except Exception as e:
            print(e)

    def selectCollection(self,nameCollection):
        assert isinstance(nameCollection, str), "The name of the Collection, %s , not is a type string." % nameCollection
        try:
            collection = CollectionMongo(self.db,nameCollection)
        except Exception as e:
            print(e)
        return collection
