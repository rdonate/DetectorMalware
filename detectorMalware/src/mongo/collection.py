# -*- coding: utf-8 -*-
from .pipeline import *
class CollectionMongo():

    def __init__(self, db,nameCollection):
        assert isinstance(nameCollection, str), "The name of the Collection, %s , not is a type string." % nameCollection
        self.collection=db[nameCollection]

    def insert(self,obj):
        self.collection.insert_one(obj)

    def find(self,a={}):
        return self.collection.find(a)

    def aggregate(self,pipeline=[{}]):
        assert isinstance(pipeline,CollectionMongo), "The pipeline not is the type Pipeline."
        return self.collection.aggregate(pipeline)

def collectionMongo(db,nameCollection):
    collection=CollectionMongo(db,nameCollection)
    return collection