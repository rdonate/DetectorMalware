# -*- coding: utf-8 -*-
from bson.son import SON
import bson
class Pipeline():
    def __init__(self,pipeline=[]):
        assert isinstance(pipeline,list), "The pipeline is not a type array."
        self.pipeline=SON(pipeline)
    def add_pipe(self,pipe):
        assert isinstance(pipe,bson), "The pipe is not a type json."
        self.pipeline.append(pipe)

def pipelineMongo(pipeline=[]):
    pipeline=Pipeline(pipeline)
    return pipeline