# -*- coding: utf-8 -*-
from .pipeline import Pipeline
class CollectionMongo():

    def __init__(self, db,nameCollection):
        assert isinstance(nameCollection, str), "The name of the Collection, %s , not is a type string." % nameCollection
        self.collection=db[nameCollection]

    def insert(self,obj):
        self.collection.insert(obj)

    def find(self,a={}):
        return self.collection.find(a)

    def find_one(self,a={}):
        return self.collection.find_one(a)

    def update_one_insert_features(self, search_element, update):
        return self.collection.update_one(search_element, {'$set':update})

    def save(self, obj):
        return self.collection.save(obj)

    def createIndex(self,index):
        assert isinstance(index,str), "The index of the  Collection, %s, not is a type String." %index
        self.collection.create_index(index)

    def aggregate(self,pipeline=[{}]):
        assert isinstance(pipeline,Pipeline), "The pipeline not is the type Pipeline."
        return self.collection.aggregate(pipeline)

    def update(self, search, obj):
        return self.collection.update(search,obj)

    def exist(self,obj={}):
        result=self.find(obj).count()
        if result>0:
            return True
        return False

    def drop(self):
        self.collection.drop()

    def isEmpty(self):
        if self.exist({})==0:
            return True
        return False

    def remove(self, obj):
        self.collection.remove(obj)