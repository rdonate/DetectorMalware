#! - * - coding UTF-8 - * -
from .extract_feature_bytes import extract_Feature_Byte as bytes
from .extract_feature_asm import extract_Features_Asm as asm
from ..mongo.database import DataBaseMongo

def extract_features(ip_Server_Mongo, db_Name, dir_Data_Raw, file, order,source):
    db = DataBaseMongo(ip_Server_Mongo, db_Name)
    collection_total = db.selectCollection(file+'_'+'total')
    data = {'_id':source[0]}
    if len(source)==2:
        data['class']=source[1]
    collection_total.insert(data)
    del data
    bytes(file, db, dir_Data_Raw, source, order)
    asm(file, db, dir_Data_Raw, source)
