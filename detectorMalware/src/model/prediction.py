#! - * - coding UTF-8 - * -

from src.model.select_features_kind import select_features
import pandas as pd


def prediction(model, ip_Server_Mongo, db_Name, prefix_collections,namesCollections,num_features, lenghtDB, dir_result, dir_SourceData):
    data = select_features(ip_Server_Mongo, db_Name, prefix_collections, namesCollections, num_features, lenghtDB)
    dir_result=dir_result+'result.csv'
    predict = model.predict_proba(data)
    file = pd.read_csv(dir_SourceData)
    file.ix[:,1:] = predict
    file.to_csv(dir_result,index=False)