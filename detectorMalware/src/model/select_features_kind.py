import numpy as np

def select_features(db, namesCollections, list_features, dir_SourceData, split_Source):
    features=None
    collection = db.selectCollection(namesCollections[2])
    with open(dir_SourceData, 'r') as file:
        text = file.read()
    sources = map(split_Source, text.split('\n')[1:-1])
    for source in sources:
        if len(source)==1:
            data = np.zeros(len(list_features))
        elif len(source)==2:
            data=np.zeros(len(list_features)+1)
        else:
            raise("Review Select Features Labels")
        for feature,index in enumerate(list_features):
            source_data = collection.find_one({'file':source[0], 'feature':feature})
            if source_data!=None:
                data[index]=source_data['count']
            else:
                data[index]=0
        if len(source)==2:
            data[-1]=source[1]
        print(data)
        if features==None:
            features=data
        else:
            features=np.vstack(features,data)
    return features

def split_features_and_class(features):
    return features[:,:-1], features[:,-1]
